<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
        <title>Main loop process invitations &mdash; Gist</title>
    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub" />
    <link rel="shortcut icon" href="https://github.com/favicon.ico" type="image/x-icon" />

    <meta content="authenticity_token" name="csrf-param" />
<meta content="UsptMycMX7jMH83wcrm9UkERxeUUp6j/MblTH/1dHWo=" name="csrf-token" />

    <link href="https://a248.e.akamai.net/assets.github.com/stylesheets/bundles/gist-635b92b29547d28d1f6769cd101e410c1b8a374d.css" media="screen" rel="stylesheet" type="text/css" />

    <script defer="defer" src="https://a248.e.akamai.net/assets.github.com/javascripts/bundles/jquery-f0a28b64b331f9c9e2f2f1111cecd94ff0ecd7a6.js" type="text/javascript"></script>
    <script defer="defer" src="https://a248.e.akamai.net/assets.github.com/javascripts/bundles/gist-3aa192b15dfb21521908aed1b6df00c569b3b8c8.js" type="text/javascript"></script>
    

    
  
  <link href="https://github.com/api/oembed?format=json&amp;url=https%3A%2F%2Fgist.github.com%2F2727107" rel="alternate" title="gist: 2727107" type="application/json+oembed" />
  

  </head>

  <body class="">
    <div id="main">
      <div id="header" class="">
        <div class="site">
          <div class="logo">
            <a href="https://gist.github.com"><img alt="gist" height="45" src="https://a248.e.akamai.net/assets.github.com/images/modules/header/logo_gist.png?1310104853" width="164" /></a>
          </div>

            <ul class="userbox logged_out">
              <ul class="usernav">
                <li><a href="/login?return_to=/2727107" rel="nofollow">Login</a></li>
                  <li><a href="https://github.com/signup?return_to=gist">Signup for a GitHub Account</a></li>
              </ul>
            </ul>

          <div class="topsearch">
<form accept-charset="UTF-8" action="/gists/search" id="top_search_form" method="get">              <input type="search" name="q" value="" results="5" class="search" placeholder="Search Gists&hellip;" /> <input type="submit" value="Search" class="button" />
              <input type="hidden" name="page" value="1" />
</form>
            <ul class="nav">
              <li><a href="https://gist.github.com">New Gist</a></li>
              <li><a href="https://gist.github.com/gists">All Gists</a></li>
              <li><a href="https://github.com">Back to GitHub</a></li>
            </ul>
          </div><!-- /.topsearch -->
        </div>
      </div>

    <div class="site">
      
<div class="secondary">

  <div id="owner">
      <div class="actor">
        <div class="gravatar">
          <img height="30" src="https://secure.gravatar.com/avatar/a2973ede78c52d060d0bd0a5d8da0226?s=140&amp;d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png" width="30" />
        </div>
        <div class="name"><a href="/brunosan">brunosan</a> <span>(owner)</span></div>
      </div>
  </div>



  <div id="revisions">
    <h3>Revisions</h3>
    <ul>
        <li class="current">
          <img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_red.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_gray.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_gray.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_gray.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_gray.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_gray.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_gray.png?1310104853" />
          <a href="https://gist.github.com/2727107/2b08d4e063f41ae3989e87c9bd129dee0d2b5c9f" class="id" rel="nofollow">2b08d4</a>

            <a href="/brunosan" class="author">brunosan</a>
          <span class="date"><time class="js-relative-date" datetime="2012-05-18T12:12:31-07:00" title="2012-05-18 12:12:31">May 18, 2012</time></span>
        </li>
        <li class="other">
          <img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_green.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_green.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_green.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_red.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_red.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_red.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_gray.png?1310104853" />
          <a href="https://gist.github.com/2727107/ce6f8b23db771f9db904fb894c4ee62d369201f2" class="id" rel="nofollow">ce6f8b</a>

            <a href="/brunosan" class="author">brunosan</a>
          <span class="date"><time class="js-relative-date" datetime="2012-05-18T12:11:36-07:00" title="2012-05-18 12:11:36">May 18, 2012</time></span>
        </li>
        <li class="other">
          <img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_green.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_green.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_green.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_green.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_green.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_green.png?1310104853" /><img alt="" src="https://a248.e.akamai.net/assets.github.com/images/gist/gist/dot_gray.png?1310104853" />
          <a href="https://gist.github.com/2727107/9732490cec2c2156359da5545cef6c9ed992c89d" class="id" rel="nofollow">973249</a>

            <a href="/brunosan" class="author">brunosan</a>
          <span class="date"><time class="js-relative-date" datetime="2012-05-18T12:11:23-07:00" title="2012-05-18 12:11:23">May 18, 2012</time></span>
        </li>
    </ul>
  </div>
</div><!-- /.secondary -->

<div class="main">
  <div id="repos" class="readability-header">
    <div class="repo public">
      <div class="title">
        <div class="path">
          gist: 2727107


            <a href="/gists/2727107/download"><img alt="Download_button" border="0" class="button" src="https://a248.e.akamai.net/assets.github.com/images/gist/buttons/download_button.png?1310104853" /></a>

            <a href="https://github.com/signup" data-method="post"><img alt="fork" class="button" src="https://a248.e.akamai.net/assets.github.com/images/gist/buttons/fork_button.png?1310104853" /></a>
        </div>

          <div class="security public_security" style="">
            <a href="#public_repo" rel="facebox"><img alt="public" src="https://a248.e.akamai.net/assets.github.com/images/gist/icons/public.png?1310104853" /></a>
          </div>

        <div id="private_repo" class="hidden">
          <h2>Private Gist</h2>
          <p>
            All pages are served over SSL and all pushing and pulling is done over SSH.
            No one may fork, clone, or view it unless they are given this private URL.
          </p>
          <p>Every gist with this icon (<img alt="private" src="https://a248.e.akamai.net/assets.github.com/images/gist/icons/private.png?1310104853" />) is private.</p>
        </div>
        <div class="security public_security" style="display:none">
          <a href="#public_repo" rel="facebox"><img alt="public" src="https://a248.e.akamai.net/assets.github.com/images/gist/icons/public.png?1310104853" /></a>
        </div>
        <div id="public_repo" class="hidden">
          <h2>Public Gist</h2>
          <p>Anyone may fork, clone, or view it.</p>
          <p>Every repository with this icon (<img alt="public" src="https://a248.e.akamai.net/assets.github.com/images/gist/icons/public.png?1310104853" />) is public.</p>
        </div>
      </div>

      <div class="meta">
        <table>
          <tr>
            <td class="label">Description:</td>
            <td>
              <div class="description">
                <span id="description" class="edit instapaper_title">Main loop process invitations</span>
              </div>
            </td>
          </tr>

            <tr>
              <td class="label">Public Clone URL:</td>
              <td>
                <a rel="#git-clone" class="git_url_facebox" href="git://gist.github.com/2727107.git">git://gist.github.com/2727107.git</a>
                <div id="git-clone" style="display:none; min-width:500px">
                  Give this clone URL to anyone.
                  <br/>

                  <code>git clone git://gist.github.com/2727107.git gist-2727107</code>
                </div>
              </td>
            </tr>


            <tr>
              <td class="label">Embed All Files:</td>
              <td>
                <a href="#" class="gist-embed-link">show embed</a>
                <input class="gist-embed-box" type="text" size="25" value='<script src="https://gist.github.com/2727107.js"> </script>' style="display:none;"/>
              </td>
            </tr>

        </table>
      </div>
    </div>
  </div>

  <div id="files" class="instapaper_body">

        <div class="file" id="file_gistfile1.js">
  <div class="meta clearfix instapaper_ignore readability-extra">
    <div class="info">
      <span class="code">
          JavaScript
        <a href="#file_gistfile1.js">#</a>
      </span>
    </div>
    <div class="actions">
      <div id="gist-embed" style="display:inline;">
        <a href="#" class="gist-embed-link">embed</a>
        <input class="gist-embed-box" size="25" style="display:none" type="text" value="&lt;script src=&quot;https://gist.github.com/2727107.js?file=gistfile1.js&quot;&gt;&lt;/script&gt;" />
      </div>
      <a href="/raw/2727107/86a592f76b9fa9c5eba700351480e3e220dc2e03/gistfile1.js">raw</a>
    </div>
  </div>
    <div class="data type-javascript">
      <table cellpadding="0" cellspacing="0" class="lines">
        <tr>
          <td>
            <pre class="line_numbers"><span id="L1" rel="#L1">1</span>
<span id="L2" rel="#L2">2</span>
<span id="L3" rel="#L3">3</span>
<span id="L4" rel="#L4">4</span>
<span id="L5" rel="#L5">5</span>
<span id="L6" rel="#L6">6</span>
<span id="L7" rel="#L7">7</span>
<span id="L8" rel="#L8">8</span>
<span id="L9" rel="#L9">9</span>
<span id="L10" rel="#L10">10</span>
<span id="L11" rel="#L11">11</span>
<span id="L12" rel="#L12">12</span>
<span id="L13" rel="#L13">13</span>
<span id="L14" rel="#L14">14</span>
<span id="L15" rel="#L15">15</span>
<span id="L16" rel="#L16">16</span>
<span id="L17" rel="#L17">17</span>
<span id="L18" rel="#L18">18</span>
<span id="L19" rel="#L19">19</span>
<span id="L20" rel="#L20">20</span>
<span id="L21" rel="#L21">21</span>
<span id="L22" rel="#L22">22</span>
<span id="L23" rel="#L23">23</span>
<span id="L24" rel="#L24">24</span>
<span id="L25" rel="#L25">25</span>
<span id="L26" rel="#L26">26</span>
<span id="L27" rel="#L27">27</span>
<span id="L28" rel="#L28">28</span>
<span id="L29" rel="#L29">29</span>
<span id="L30" rel="#L30">30</span>
<span id="L31" rel="#L31">31</span>
<span id="L32" rel="#L32">32</span>
<span id="L33" rel="#L33">33</span>
<span id="L34" rel="#L34">34</span>
<span id="L35" rel="#L35">35</span>
<span id="L36" rel="#L36">36</span>
<span id="L37" rel="#L37">37</span>
<span id="L38" rel="#L38">38</span>
<span id="L39" rel="#L39">39</span>
<span id="L40" rel="#L40">40</span>
<span id="L41" rel="#L41">41</span>
<span id="L42" rel="#L42">42</span>
<span id="L43" rel="#L43">43</span>
<span id="L44" rel="#L44">44</span>
<span id="L45" rel="#L45">45</span>
<span id="L46" rel="#L46">46</span>
<span id="L47" rel="#L47">47</span>
<span id="L48" rel="#L48">48</span>
<span id="L49" rel="#L49">49</span>
<span id="L50" rel="#L50">50</span>
<span id="L51" rel="#L51">51</span>
<span id="L52" rel="#L52">52</span>
<span id="L53" rel="#L53">53</span>
<span id="L54" rel="#L54">54</span>
<span id="L55" rel="#L55">55</span>
<span id="L56" rel="#L56">56</span>
<span id="L57" rel="#L57">57</span>
<span id="L58" rel="#L58">58</span>
<span id="L59" rel="#L59">59</span>
<span id="L60" rel="#L60">60</span>
<span id="L61" rel="#L61">61</span>
<span id="L62" rel="#L62">62</span>
<span id="L63" rel="#L63">63</span>
</pre>
          </td>
          <td width="100%">
                <div class="highlight"><pre><div class='line' id='LC1'><span class="kd">function</span> <span class="nx">ProcessList</span><span class="p">()</span> <span class="p">{</span></div><div class='line' id='LC2'>&nbsp;&nbsp;&nbsp;<span class="nx">sendEmail</span> <span class="o">=</span><span class="mi">0</span> <span class="p">;</span></div><div class='line' id='LC3'>&nbsp;&nbsp;&nbsp;<span class="c1">// Track remaining email quota.</span></div><div class='line' id='LC4'>&nbsp;&nbsp;&nbsp;<span class="kd">var</span> <span class="nx">budget</span> <span class="o">=</span> <span class="nx">MailApp</span><span class="p">.</span><span class="nx">getRemainingDailyQuota</span><span class="p">();</span></div><div class='line' id='LC5'><br/></div><div class='line' id='LC6'>&nbsp;&nbsp;<span class="c1">// For every person</span></div><div class='line' id='LC7'>&nbsp;&nbsp;<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span></div><div class='line' id='LC8'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nx">budget</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">){</span></div><div class='line' id='LC9'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">Browser</span><span class="p">.</span><span class="nx">msgBox</span><span class="p">(</span><span class="s2">&quot;Sorry, your account has reached your daily quote of emails.&quot;</span><span class="p">)</span></div><div class='line' id='LC10'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">break</span><span class="p">;</span></div><div class='line' id='LC11'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>  </div><div class='line' id='LC12'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">var</span> <span class="nx">row</span> <span class="o">=</span> <span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="c1">//row is the info of the person</span></div><div class='line' id='LC13'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nx">row</span><span class="p">.</span><span class="nx">state</span> <span class="o">==</span> <span class="nx">GO</span> <span class="p">)</span> <span class="p">{</span></div><div class='line' id='LC14'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// empty means do nothing</span></div><div class='line' id='LC15'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// &quot;Go&quot; means this is a new invitee AND we want to send him an invite.</span></div><div class='line' id='LC16'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// Email the person to request his response.</span></div><div class='line' id='LC17'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">switch</span><span class="p">(</span><span class="nx">row</span><span class="p">.</span><span class="nx">group</span><span class="p">)</span></div><div class='line' id='LC18'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class='line' id='LC19'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="mi">1</span><span class="o">:</span></div><div class='line' id='LC20'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">send1ToInvitee</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span></div><div class='line' id='LC21'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">Log</span><span class="o">+=</span><span class="s2">&quot;(+&quot;</span><span class="o">+</span><span class="nx">delay</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; s.) SENDING email to &quot;</span><span class="o">+</span><span class="nx">row</span><span class="p">.</span><span class="nx">firstName</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">row</span><span class="p">.</span><span class="nx">lastName</span><span class="o">+</span><span class="s2">&quot;. Group 1&lt;br&gt;&quot;</span><span class="p">;</span></div><div class='line' id='LC22'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">break</span><span class="p">;</span> </div><div class='line' id='LC23'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="mi">2</span><span class="o">:</span></div><div class='line' id='LC24'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">send2ToInvitee</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span></div><div class='line' id='LC25'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">Log</span><span class="o">+=</span><span class="s2">&quot;(+&quot;</span><span class="o">+</span><span class="nx">delay</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; s.) SENDING email to &quot;</span><span class="o">+</span><span class="nx">row</span><span class="p">.</span><span class="nx">firstName</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">row</span><span class="p">.</span><span class="nx">lastName</span><span class="o">+</span><span class="s2">&quot;. Group 2&lt;br&gt;&quot;</span><span class="p">;</span></div><div class='line' id='LC26'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">break</span><span class="p">;</span> </div><div class='line' id='LC27'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">default</span><span class="o">:</span></div><div class='line' id='LC28'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">Log</span><span class="o">+=</span><span class="s2">&quot;(+&quot;</span><span class="o">+</span><span class="nx">delay</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; s.) No Group set for &quot;</span><span class="o">+</span><span class="nx">row</span><span class="p">.</span><span class="nx">firstName</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">row</span><span class="p">.</span><span class="nx">lastName</span><span class="o">+</span><span class="s2">&quot;. ERROR&lt;br&gt;&quot;</span><span class="p">;</span></div><div class='line' id='LC29'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>     </div><div class='line' id='LC30'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// Update the state of the report to avoid email sending multiple emails</span></div><div class='line' id='LC31'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">budget</span><span class="o">=</span><span class="nx">budget</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span></div><div class='line' id='LC32'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">sheet</span><span class="p">.</span><span class="nx">getRange</span><span class="p">(</span><span class="nx">row</span><span class="p">.</span><span class="nx">id</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="nx">COLUMN_STATE</span><span class="p">).</span><span class="nx">setValue</span><span class="p">(</span><span class="nx">row</span><span class="p">.</span><span class="nx">state</span><span class="p">);</span></div><div class='line' id='LC33'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// Flush to update sheet, in case script breaks.</span></div><div class='line' id='LC34'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">flush</span><span class="p">();</span>    </div><div class='line' id='LC35'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span> </div><div class='line' id='LC36'>&nbsp;&nbsp;&nbsp;&nbsp;</div><div class='line' id='LC37'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">//ReadReplies to see if that person replied</span></div><div class='line' id='LC38'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// Check if the person has accepted or rejected the invitation in the Reply Spreadsheet.</span></div><div class='line' id='LC39'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// We look that the tokens match. If they replied more than once, the last prevails.</span></div><div class='line' id='LC40'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">((</span><span class="nx">row</span><span class="p">.</span><span class="nx">state</span> <span class="o">==</span> <span class="nx">EMAIL_SENT</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span></div><div class='line' id='LC41'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">//Check for replies and send email</span></div><div class='line' id='LC42'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">sendEmail</span> <span class="o">=</span><span class="mi">1</span> <span class="p">;</span></div><div class='line' id='LC43'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">readReplies</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span></div><div class='line' id='LC44'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">sendEmail</span> <span class="o">=</span><span class="mi">0</span> <span class="p">;</span></div><div class='line' id='LC45'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class='line' id='LC46'>&nbsp;&nbsp;&nbsp;&nbsp;</div><div class='line' id='LC47'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">//Case for row.state == REPLIED is taken out. It would check or NEW replies.</span></div><div class='line' id='LC48'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">//Moved to checklNewReplies</span></div><div class='line' id='LC49'>&nbsp;&nbsp;&nbsp;&nbsp;</div><div class='line' id='LC50'>&nbsp;&nbsp;&nbsp;&nbsp;</div><div class='line' id='LC51'>&nbsp;&nbsp;<span class="p">}</span> <span class="c1">// for every person </span></div><div class='line' id='LC52'>&nbsp;&nbsp;<span class="nx">Log</span><span class="o">+=</span><span class="s2">&quot;(+&quot;</span><span class="o">+</span><span class="nx">delay</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; s.) Ended execution.&quot;</span><span class="p">;</span></div><div class='line' id='LC53'>&nbsp;&nbsp;<span class="nx">MailApp</span><span class="p">.</span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">Session</span><span class="p">.</span><span class="nx">getUser</span><span class="p">().</span><span class="nx">getEmail</span><span class="p">(),</span></div><div class='line' id='LC54'>&nbsp;&nbsp;&nbsp;<span class="s2">&quot;Output of Processing list&quot;</span><span class="p">,</span></div><div class='line' id='LC55'>&nbsp;&nbsp;&nbsp;<span class="s2">&quot;&quot;</span><span class="p">,</span> </div><div class='line' id='LC56'>&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class='line' id='LC57'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">htmlBody</span><span class="o">:</span> <span class="nx">Log</span><span class="p">,</span></div><div class='line' id='LC58'>&nbsp;&nbsp;&nbsp;<span class="c1">//  attachments: pdf,</span></div><div class='line' id='LC59'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">bcc</span><span class="o">:</span> <span class="nx">ITPERSON</span></div><div class='line' id='LC60'>&nbsp;&nbsp;&nbsp;<span class="p">});</span></div><div class='line' id='LC61'>&nbsp;&nbsp;&nbsp;</div><div class='line' id='LC62'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">Browser</span><span class="p">.</span><span class="nx">msgBox</span><span class="p">(</span><span class="s2">&quot;Smile. I&#39;ve finished (&quot;</span><span class="o">+</span><span class="nx">delay</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; s)&quot;</span><span class="p">);</span></div><div class='line' id='LC63'><span class="p">}</span></div></pre></div>
          </td>
        </tr>
      </table>
  </div>

</div>


     <!-- cache end -->


  </div>

    <div id="comments">

        Please <a href="/login?return_to=%2F2727107">log in</a> to comment.
    </div>

</div><!-- /.main -->

    </div> <!-- site -->

    <div class="push"></div>

    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="logo">
            <a href="https://github.com">
              <img alt="GitHub" src="https://a248.e.akamai.net/assets.github.com/images/modules/header/logo_white.png?1310104853" />
            </a>
          </div>
          <div class="more">
            <div class="links">
              <a href="https://github.com/blog"><strong>Blog</strong></a> |
              <a href="https://github.com/about">About</a> |
              <a href="https://github.com/contact">Support</a> |
              <a href="https://github.com/contact">Contact</a> |
              <a href="https://github.com/site/privacy">Privacy</a> |
              <a href="https://github.com/site/terms">Terms of Service</a>
            </div>
            <div class="company">
              &copy;
              2011
              <span title="0.68159s from fe8.rs.github.com">GitHub</span> Inc.
              All rights reserved.
           </div>
          </div>
        </div>
        <div class="sponsor">
          <div>
            Powered by the <a href="http://www.rackspace.com ">Dedicated
            Servers</a> and<br/> <a href="http://www.rackspacecloud.com">Cloud
            Computing</a> of Rackspace Hosting<span>&reg;</span>
          </div>
          <a href="http://www.rackspace.com">
            <img alt="Dedicated Server" src="https://a248.e.akamai.net/assets.github.com/images/modules/footer/rackspaces_logo.png?1329521041" />
          </a>
        </div>
      </div>
    </div>
  </body>
</html>
